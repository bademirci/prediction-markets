{
  "dashboard": {
    "id": null,
    "uid": "polymarket-final",
    "title": "Polymarket Trading Dashboard",
    "tags": ["polymarket", "esports", "trading"],
    "timezone": "browser",
    "refresh": "5s",
    "templating": {
      "list": [
        {
          "name": "category",
          "label": "Category",
          "type": "query",
          "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
          "definition": "SELECT DISTINCT computed_category FROM polymarket.markets_dim WHERE updated_at >= now() - INTERVAL 1 DAY ORDER BY computed_category",
          "query": "SELECT DISTINCT computed_category FROM polymarket.markets_dim WHERE updated_at >= now() - INTERVAL 1 DAY ORDER BY computed_category",
          "current": {"text": "Esports", "value": "Esports"},
          "refresh": 1,
          "sort": 1
        },
        {
          "name": "market",
          "label": "Market", 
          "type": "query",
          "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
          "definition": "SELECT condition_id AS __value, argMax(question, updated_at) AS __text FROM polymarket.markets_dim WHERE updated_at >= now() - INTERVAL 1 DAY AND computed_category = '${category}' GROUP BY condition_id ORDER BY __text LIMIT 50000",
          "query": "SELECT condition_id AS __value, argMax(question, updated_at) AS __text FROM polymarket.markets_dim WHERE updated_at >= now() - INTERVAL 1 DAY AND computed_category = '${category}' GROUP BY condition_id ORDER BY __text LIMIT 50000",
          "refresh": 1,
          "sort": 0
        },
        {
          "name": "token",
          "label": "Token",
          "type": "query",
          "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
          "definition": "SELECT arrayJoin(argMax(clob_token_ids, updated_at)) AS token_id FROM polymarket.markets_dim WHERE condition_id = '${market}'",
          "query": "SELECT arrayJoin(argMax(clob_token_ids, updated_at)) AS token_id FROM polymarket.markets_dim WHERE condition_id = '${market}'",
          "refresh": 1
        }
      ]
    },
    "panels": [
      {
        "id": 1,
        "title": "ðŸ“ˆ Price Chart (Trades)",
        "type": "timeseries",
        "gridPos": {"x": 0, "y": 0, "w": 16, "h": 10},
        "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
        "targets": [
          {
            "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
            "queryType": "sql",
            "rawSql": "SELECT exchange_ts AS time, price FROM polymarket.trades_raw WHERE condition_id = '${market}' AND token_id = '${token}' AND exchange_ts >= now() - INTERVAL 2 HOUR ORDER BY exchange_ts",
            "refId": "A",
            "format": 1
          }
        ],
        "fieldConfig": {
          "defaults": {"unit": "percentunit", "min": 0, "max": 1, "custom": {"drawStyle": "points", "pointSize": 5}}
        }
      },
      {
        "id": 2,
        "title": "ðŸ“Š Trades/min (All Markets)",
        "type": "timeseries",
        "gridPos": {"x": 16, "y": 0, "w": 8, "h": 5},
        "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
        "targets": [
          {
            "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
            "queryType": "sql",
            "rawSql": "SELECT toStartOfMinute(exchange_ts) AS time, count() AS trades FROM polymarket.trades_raw WHERE exchange_ts >= now() - INTERVAL 2 HOUR GROUP BY time ORDER BY time",
            "refId": "A",
            "format": 1
          }
        ]
      },
      {
        "id": 3,
        "title": "ðŸ“¡ Orderbook Updates/min",
        "type": "timeseries",
        "gridPos": {"x": 16, "y": 5, "w": 8, "h": 5},
        "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
        "targets": [
          {
            "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
            "queryType": "sql",
            "rawSql": "SELECT toStartOfMinute(exchange_ts) AS time, count() AS orderbook_updates FROM polymarket.orderbook_levels WHERE exchange_ts >= now() - INTERVAL 2 HOUR AND level = 1 GROUP BY time ORDER BY time",
            "refId": "A",
            "format": 1
          }
        ]
      },
      {
        "id": 4,
        "title": "ðŸ“Š 5-Min Volume (Selected Market)",
        "type": "barchart",
        "gridPos": {"x": 0, "y": 10, "w": 12, "h": 8},
        "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
        "targets": [
          {
            "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
            "queryType": "sql",
            "rawSql": "SELECT toStartOfInterval(exchange_ts, INTERVAL 5 MINUTE) AS time, sumIf(price * size, side = 'BUY') AS Buy, sumIf(price * size, side = 'SELL') AS Sell FROM polymarket.trades_raw WHERE condition_id = '${market}' AND exchange_ts >= now() - INTERVAL 2 HOUR GROUP BY time ORDER BY time",
            "refId": "A",
            "format": 1
          }
        ]
      },
      {
        "id": 5,
        "title": "ðŸ“ˆ Cumulative Volume",
        "type": "timeseries",
        "gridPos": {"x": 12, "y": 10, "w": 12, "h": 8},
        "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
        "targets": [
          {
            "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
            "queryType": "sql",
            "rawSql": "SELECT exchange_ts AS time, sum(price * size) OVER (ORDER BY exchange_ts) AS cumulative FROM polymarket.trades_raw WHERE condition_id = '${market}' AND exchange_ts >= now() - INTERVAL 2 HOUR ORDER BY exchange_ts",
            "refId": "A",
            "format": 1
          }
        ]
      },
      {
        "id": 6,
        "title": "âš¡ Network Latency (delta_t_ms)",
        "type": "timeseries",
        "gridPos": {"x": 0, "y": 18, "w": 12, "h": 8},
        "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
        "targets": [
          {
            "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
            "queryType": "sql",
            "rawSql": "SELECT toStartOfMinute(exchange_ts) AS time, avg(delta_t_ms) AS avg_latency_ms, max(delta_t_ms) AS max_latency_ms FROM polymarket.trades_raw WHERE condition_id = '${market}' AND exchange_ts >= now() - INTERVAL 2 HOUR GROUP BY time ORDER BY time",
            "refId": "A",
            "format": 1
          }
        ],
        "fieldConfig": {
          "defaults": {"unit": "ms"}
        }
      },
      {
        "id": 7,
        "title": "ðŸ† Top Active Markets (${category})",
        "type": "table",
        "gridPos": {"x": 12, "y": 18, "w": 12, "h": 8},
        "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
        "targets": [
          {
            "datasource": {"type": "grafana-clickhouse-datasource", "uid": "ff9v08z0shkw0e"},
            "queryType": "sql",
            "rawSql": "SELECT any(m.question) AS Market, count() AS Trades, round(sum(t.price * t.size), 2) AS Volume FROM polymarket.trades_raw t JOIN polymarket.markets_dim m ON t.condition_id = m.condition_id WHERE t.exchange_ts >= now() - INTERVAL 2 HOUR AND m.computed_category = '${category}' GROUP BY t.condition_id ORDER BY Trades DESC LIMIT 15",
            "refId": "A",
            "format": 2
          }
        ]
      }
    ],
    "time": {"from": "now-2h", "to": "now"},
    "schemaVersion": 39
  },
  "overwrite": true
}
